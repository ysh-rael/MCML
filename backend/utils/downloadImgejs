const axios = require('axios');
const fs = require('fs');

const { Print } = require('./print');
const print = new Print({ informa: 'Utils downloadImge', alerta: 'Utils downloadImge', erro: 'Utils downloadImge', sucesso: 'Utils downloadImge' });

async function downloadImge(localPath, url) {
    try {
        const resposta = await axios({
            method: 'get',
            url: url,
            responseType: 'stream',
        });

        // Salva a imagem localmente
        resposta.data.pipe(fs.createWriteStream(localPath));

        return new Promise((resolve, reject) => {
            resposta.data.on('end', () => resolve(localPath));
            resposta.data.on('error', (erro) => reject(`erro.message`));
        });
    } catch (erro) {
        print.erro(`Catch: ${erro.message}`)
    }
}

module.exports = { downloadImge }
